

<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">

  



<title>Deployando seu site em Hugo no Github Pages com Circle CI - Felipeweb</title>


<meta name="keywords" content="Devops">
<link rel="amphtml" href="https://r.amply.cloud/?url=https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f">



  <meta name="author" content="Felipeweb">
  <base href="https://felipeweb.dev/">
  <link rel="canonical" href="https://felipeweb.dev/post/deployando-site-hugo-automaticamente-com-circleci-no-ghpages/">

  <meta name="generator" content="Hugo 0.72.0" />

  
  
  

  
  <link href="https://felipeweb.dev/css/main.css?hash=1592582709" rel="stylesheet">
  <link href="https://felipeweb.dev/css/highlightjs-dracula.css?hash=1592582709" rel="stylesheet">

  
  <link href="https://fonts.googleapis.com/css?family=Roboto|Roboto+Mono|Inconsolata" rel="stylesheet">
  <link href="https://cdn.materialdesignicons.com/2.0.46/css/materialdesignicons.min.css" rel="stylesheet">
</head>

<body lang="en-us">



<div class="menu">
  <div class="container">
    <div class="row">
      <div class="menu__wrapper d-none d-lg-block col-md-12">
        <nav class="">
          <ul>
            <li><a href="#hello">Home</a></li>
            
            <li><a href="https://felipeweb.dev/talk/#content" alt="content Talks">Talks</a></li>
            
            <li><a href="https://felipeweb.dev/post/#content" alt="content Posts">Posts</a></li>
            
            <li><a href="https://felipeweb.dev/resume.pdf">Resume</a></li>
          </ul>
        </nav>
      </div>
      <div class="menu__wrapper col-md-12 d-lg-none">
        <button type="button" class="menu__mobile-button">
          <span><i class="fa fa-bars" aria-hidden="true"></i></span>
        </button>
      </div>
    </div>
  </div>
</div>



<div class="mobile-menu d-lg-none">
  <div class="container">
    <div class="mobile-menu__close">
      <span><i class="mdi mdi-close" aria-hidden="true"></i></span>
    </div>
    <nav class="mobile-menu__wrapper">
      <ul>
        <li><a href="#hello">Hello</a></li>
        <li><a href="#portfolio">Projects</a></li>
        
        <li><a href="https://felipeweb.dev/talk/#content" alt="content Talks">Talks</a></li>
        
        <li><a href="https://felipeweb.dev/post/#content" alt="content Posts">Posts</a></li>
        
      </ul>
    </nav>
  </div>
</div>



<header class="background blog-header"></header>



<div class="container">
  <div class="article">
    <div class="row">
      <div class="col-md-12">
        <a class="article__back-link" href="/"><i class="fa fa-long-arrow-left" aria-hidden="true"></i>Back</a>

        <h1 class="article__title">Deployando seu site em Hugo no Github Pages com Circle CI</h1>
        <p class="article_date">
	  Mar 17, 2019 | 2 minutes read
	</p>
	
<p class="article__share">Share this post:
  <a rel="nofollow" href="https://twitter.com/intent/tweet?text=Deployando%20seu%20site%20em%20Hugo%20no%20Github%20Pages%20com%20Circle%20CI https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f by @_felipeweb" target="_blank"><i class="fa fa-twitter-square"></i></a>
  <a rel="nofollow" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f"><i class="fa fa-facebook-square"></i></a>
  <a rel="nofollow" href="https://www.linkedin.com/cws/share?url=https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f"><i class="fa fa-linkedin-square"></i></a>
  <a rel="nofollow" href="https://plus.google.com/share?url=https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f"><i class="fa fa-google-plus-square"></i></a>
  <a rel="nofollow" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f"><i class="fa fa-pinterest-square"></i></a>
</p>



	<p>Hoje vamos ver como automatizar o deploy de um site em Hugo no Github Pages com Circle CI, serão 2 passos o de gerar o site e o de fazer deploy.</p>
<h2 id="definindo-o-workflow">Definindo o workflow</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">workflows</span>:
  <span style="color:#66d9ef">version</span>: <span style="color:#ae81ff">2</span>
  <span style="color:#66d9ef">build</span>:
    <span style="color:#66d9ef">jobs</span>:
      - build
      - <span style="color:#66d9ef">deploy</span>:
          <span style="color:#66d9ef">requires</span>:
            - build
          <span style="color:#66d9ef">filters</span>:
            <span style="color:#66d9ef">branches</span>:
              <span style="color:#66d9ef">only</span>: master
</code></pre></div><p>Além definir os 2 passos colocamos filtros para que o passo de deploy aconteça somente quando fizermos commit na branch master e se o passo de build finalizar com sucesso.</p>
<h2 id="gerando-o-site">Gerando o site</h2>
<p>Vamos configurar o Circle CI para rodar o comando <code>hugo</code> para gerar o site no diretório <code>public</code> usando a imagem docker <code>cibuilds/hugo</code> e persista o diretório para usarmos no proximo passo.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">build</span>:
    <span style="color:#66d9ef">docker</span>:
      - <span style="color:#66d9ef">image</span>: cibuilds/hugo
    <span style="color:#66d9ef">steps</span>:
      - checkout
      - <span style="color:#66d9ef">run</span>:
          <span style="color:#66d9ef">name</span>: Build site
          <span style="color:#66d9ef">command</span>: hugo
      - <span style="color:#66d9ef">persist_to_workspace</span>:
          <span style="color:#66d9ef">root</span>: ./
          <span style="color:#66d9ef">paths</span>: public
</code></pre></div><h2 id="fazendo-o-deploy">Fazendo o deploy</h2>
<p>Vamos configurar o Circle CI para rodar o comando <code>gh-pages</code>. Vamos instalar usando a imagem docker <code>circleci/node</code> e o <code>npm</code> e depois configurar o <code>git</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">deploy</span>:
    <span style="color:#66d9ef">docker</span>:
      - <span style="color:#66d9ef">image</span>: circleci/node
    <span style="color:#66d9ef">steps</span>:
      - checkout
      - <span style="color:#66d9ef">attach_workspace</span>:
          <span style="color:#66d9ef">at</span>: ./
      - <span style="color:#66d9ef">run</span>:
          <span style="color:#66d9ef">name</span>: Install and configure dependencies
          <span style="color:#66d9ef">command</span>: <span style="color:#e6db74">|
</span><span style="color:#e6db74">            sudo npm install -g gh-pages</span>
            git config user.email <span style="color:#e6db74">&#34;felipeweb.programador@gmail.com&#34;</span>
            git config user.name <span style="color:#e6db74">&#34;felipeweb&#34;</span>
      - <span style="color:#66d9ef">run</span>:
          <span style="color:#66d9ef">name</span>: deploy site
          <span style="color:#66d9ef">command</span>: gh-pages --dotfiles --repo https://$GITHUB_TOKEN@github.com/felipeweb/felipeweb.dev.git --message <span style="color:#e6db74">&#34;[skip ci] update site&#34;</span> --dist ./public
</code></pre></div><h2 id="adicionando-token-do-github-no-circle-ci">Adicionando token do Github no Circle CI</h2>
<p>Vamos acessar o <a href="https://circleci.com/gh/felipeweb/felipeweb.dev/edit#env-vars">Circle CI</a> e adicionar a variável.</p>
<p><img src="/img/circleci.png" alt=""></p>
<h2 id="conclusão">Conclusão</h2>
<p>No final temos o YAML abaixo:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">version</span>: <span style="color:#ae81ff">2</span>
<span style="color:#66d9ef">jobs</span>:
  <span style="color:#66d9ef">build</span>:
    <span style="color:#66d9ef">docker</span>:
      - <span style="color:#66d9ef">image</span>: cibuilds/hugo
    <span style="color:#66d9ef">steps</span>:
      - checkout
      - <span style="color:#66d9ef">run</span>:
          <span style="color:#66d9ef">name</span>: Build site
          <span style="color:#66d9ef">command</span>: hugo
      - <span style="color:#66d9ef">persist_to_workspace</span>:
          <span style="color:#66d9ef">root</span>: ./
          <span style="color:#66d9ef">paths</span>: public
  <span style="color:#66d9ef">deploy</span>:
    <span style="color:#66d9ef">docker</span>:
      - <span style="color:#66d9ef">image</span>: circleci/node
    <span style="color:#66d9ef">steps</span>:
      - checkout
      - <span style="color:#66d9ef">attach_workspace</span>:
          <span style="color:#66d9ef">at</span>: ./
      - <span style="color:#66d9ef">run</span>:
          <span style="color:#66d9ef">name</span>: Install and configure dependencies
          <span style="color:#66d9ef">command</span>: <span style="color:#e6db74">|
</span><span style="color:#e6db74">            sudo npm install -g gh-pages</span>
            git config user.email <span style="color:#e6db74">&#34;fpo@felipeweb.dev&#34;</span>
            git config user.name <span style="color:#e6db74">&#34;felipeweb&#34;</span>
      - <span style="color:#66d9ef">run</span>:
          <span style="color:#66d9ef">name</span>: deploy site
          <span style="color:#66d9ef">command</span>: gh-pages --dotfiles --repo https://$GITHUB_TOKEN@github.com/felipeweb/felipeweb.dev.git --message <span style="color:#e6db74">&#34;[skip ci] update site&#34;</span> --dist ./public
<span style="color:#66d9ef">workflows</span>:
  <span style="color:#66d9ef">version</span>: <span style="color:#ae81ff">2</span>
  <span style="color:#66d9ef">build</span>:
    <span style="color:#66d9ef">jobs</span>:
      - build
      - <span style="color:#66d9ef">deploy</span>:
          <span style="color:#66d9ef">requires</span>:
            - build
          <span style="color:#66d9ef">filters</span>:
            <span style="color:#66d9ef">branches</span>:
              <span style="color:#66d9ef">only</span>: master
</code></pre></div><p>Espero que tenham gostado até a proxima!</p>


	
<p class="article__share">Share this post:
  <a rel="nofollow" href="https://twitter.com/intent/tweet?text=Deployando%20seu%20site%20em%20Hugo%20no%20Github%20Pages%20com%20Circle%20CI https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f by @_felipeweb" target="_blank"><i class="fa fa-twitter-square"></i></a>
  <a rel="nofollow" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f"><i class="fa fa-facebook-square"></i></a>
  <a rel="nofollow" href="https://www.linkedin.com/cws/share?url=https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f"><i class="fa fa-linkedin-square"></i></a>
  <a rel="nofollow" href="https://plus.google.com/share?url=https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f"><i class="fa fa-google-plus-square"></i></a>
  <a rel="nofollow" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2ffelipeweb.dev%2fpost%2fdeployando-site-hugo-automaticamente-com-circleci-no-ghpages%2f"><i class="fa fa-pinterest-square"></i></a>
</p>



	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "felipewebcloud" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
    </div>
  </div>
</div>




<div class="background">
  <div id="contact" class="container section">
    <div class="row contacts">
      <div class="col-lg-12">
        <div class="footer">

          
<p class="personal-profile__social">
  <a rel="nofollow" href="https://github.com/felipeweb" target="_blank"><i class="fa fa-github-square"></i></a>
  
  <a rel="nofollow" href="https://twitter.com/_felipeweb" target="_blank"><i class="fa fa-twitter-square"></i></a>
  
  <a rel="nofollow" href="https://linkedin.com/in/felipewebcloud" target="_blank"><i class="fa fa-linkedin-square"></i></a>
  
</p>



          
          <p>written by Felipeweb</p>
          
        </div>
      </div>
    </div>
  </div>
</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"
  integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"
  integrity="sha256-jDnOKIOq2KNsQZTcBTEnsp76FnfMEttF6AV2DF2fFNE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/languages/go.min.js"></script>


<script src="https://felipeweb.dev/js/menu.js?hash=1592582709"></script>
<script src="https://felipeweb.dev/js/progress-list.js?hash=1592582709"></script>
<script src="https://felipeweb.dev/js/section.js?hash=1592582709"></script>
<script src="https://felipeweb.dev/js/mobile-menu.js?hash=1592582709"></script>
<script src="https://felipeweb.dev/js/mbclicker.min.js?hash=1592582709"></script>
<script>hljs.initHighlightingOnLoad();</script>



<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-57220118-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>

</html>
